<!--/* default 레이아웃을 사용하는 템플릿*/-->
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{thymeleaf/layout/popup}">
<head>
  <title>북레이 - 상품 태그 등록</title>
  <link href="/css/product/inputDisabled.css" rel="stylesheet">
</head>
<!---->
<th:block layout:fragment="content">
  <form>
    <input type="text">
    <input type="submit" value="검색">
  </form>
  <hr>
  <table>
    <thead>
    <tr>
      <th>태그 번호</th>
      <th>태그 이름</th>
      <th>태그 삭제</th>
      <th>등록 여부</th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    <th:block th:each="tag : ${tagList}">
      <tr>
        <td><span th:text="${tag.id}"/></td>
        <td>
          <form method="post"
                th:action="@{/admin/tag/connection/update/{productNo}/{pageNum} (productNo=${productNo}, pageNum=${totalPage})}">
            <input name="id" type="number" th:value="${tag.id}" hidden/>
            <input name="name" class="name-input" type="text" th:value="${tag.name}"
                   disabled="disabled"/>
            <input class="submit-btn" type="submit" value="수정 제출" hidden="hidden"/>
            <span class="btn btn-outline-primary update-button">수정</span>
          </form>
        </td>
        <td>
          <form method="post"
                th:action="@{/admin/tag/connection/delete/{productNo}/{pageNum} (productNo=${productNo}, pageNum=${totalPage})}">
            <input name="id" type="number" th:value="${tag.id}" hidden/>
            <input class="btn btn-outline-primary submit-btn" type="submit" value="삭제"/>
          </form>
        </td>
        <td>
          <form th:if="${tag.isRegistered()==true}" method="post"
                th:action="@{/admin/tag/connection/disconnect/{productNo}/{pageNum} (productNo=${productNo}, pageNum=${totalPage})}">
            <input name="tagId" type="number" th:value="${tag.id}" hidden="hidden"/>
            <input name="productNo" type="number" th:value="${productNo}" hidden="hidden"/>
            <input class="btn btn-outline-primary" type="submit" value="등록 취소">
          </form>

          <form th:if="${tag.isRegistered()==false}" method="post"
                th:action="@{/admin/tag/connection/{productNo}/{pageNum} (productNo=${productNo}, pageNum=${totalPage})}">
            <input name="tagId" type="number" th:value="${tag.id}" hidden="hidden"/>
            <input name="productNo" type="number" th:value="${productNo}" hidden="hidden"/>
            <input class="btn btn-outline-primary" type="submit" value="등록">
          </form>
        </td>
      </tr>
    </th:block>
    </tbody>

  </table>

  <th:block th:replace="thymeleaf/fragments/pagination :: pagination"></th:block>

  <hr>

  <h3>새 테그 등록</h3>
  <form method="post"
        th:action="@{/admin/tag/connection/create/{productNo}/{pageNum}(productNo=${productNo}, pageNum=${totalPage})}"/>
  <p>테그명 : <input type="text" name="name">
    <input class="btn btn-outline-primary" type="submit" value="등록"/></p>
  </form>


  <script>
    const updateBtns = document.querySelectorAll('.update-button');
    updateBtns.forEach(function (item) {
      item.addEventListener('click', function () { // 클릭 이벤트 발생시,
        var form1 = this.closest('form'); // 클릭 이벤트가 발생한 버튼에 제일 가까운 폼을 찾고,
        form1.querySelector('.name-input').toggleAttribute('disabled')
        form1.querySelector('.submit-btn').toggleAttribute('hidden')
      });
    });
  </script>
</th:block>
<!---->
</html>
